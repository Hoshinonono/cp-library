---
data:
  _extendedDependsOn:
  - icon: ':x:'
    path: Graph/steiner_tree.hpp
    title: Graph/steiner_tree.hpp
  _extendedRequiredBy: []
  _extendedVerifiedWith: []
  _isVerificationFailed: true
  _pathExtension: cpp
  _verificationStatusIcon: ':x:'
  attributes: {}
  bundledCode: "#line 1 \"Test/yukicoder/yuki0114.test.cpp\"\n#define PROBLEM \"https://yukicoder.me/problems/no/114\"\
    \n\n#include <bits/stdc++.h>\n#include <atcoder/all>\n#line 1 \"Graph/steiner_tree.hpp\"\
    \ntemplate <class T> std::vector<T> steiner_tree(std::vector<std::vector<std::pair<int,\
    \ T>>> &G, \r\n\t\t\t\t\t\t\t\tstd::vector<int> &terminal){\r\n    const int N\
    \ = G.size(), t = terminal.size();\r\n\tif(t == 0) {\r\n\t\tstd::vector<T> ans(N);\r\
    \n\t\treturn ans;\r\n\t}\r\n\tstd::vector<std::vector<T>> dp(1 << t, std::vector<T>(N,\
    \ std::numeric_limits<T>::max() / 2));\r\n\tfor(int i = 0; i < t; i++){\r\n\t\t\
    assert(0 <= terminal[i] && terminal[i] < N);\r\n\t\tdp[1 << i][terminal[i]] =\
    \ 0;\r\n\t}\r\n\tstd::priority_queue<std::pair<T, int>, \r\n\t\tstd::vector<std::pair<T,\
    \ int>>, std::greater<std::pair<T, int>>> pq;\r\n\tfor(int S = 1; S < (1 << t);\
    \ S++){\r\n\t\tfor(int v = 0; v < N; v++){\r\n\t\t\tfor(int U = S & (S - 1); U\
    \ > 0; U = (U - 1) & S){\r\n\t\t\t\tdp[S][v] = std::min(dp[S][v], dp[U][v] + dp[U\
    \ ^ S][v]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor(int v = 0; v < N; v++) pq.emplace(dp[S][v],\
    \ v);\r\n\t\twhile(!pq.empty()){\r\n\t\t\tauto [d, v] = pq.top();\r\n\t\t\tpq.pop();\r\
    \n\t\t\tif(d > dp[S][v])continue;\r\n\t\t\tfor(auto &&[u, w] : G[v]){\r\n\t\t\t\
    \tif(d + w >= dp[S][u]) continue;\r\n\t\t\t\tdp[S][u] = d + w;\r\n\t\t\t\tpq.emplace(dp[S][u],\
    \ u);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn dp.back();\r\n}\n#line 6 \"Test/yukicoder/yuki0114.test.cpp\"\
    \nusing ll = long long;\n\nusing namespace std;\n\nint main(){\n\tios::sync_with_stdio(false);\n\
    \tcin.tie(0);\n\tint N, M, T;\n\tcin >> N >> M >> T;\n\tvector<int> ter(T);\n\t\
    if(T <= 16){\n\t\tvector<vector<pair<int,int>>> G(N);\n\t\tfor(int i = 0; i <\
    \ M; i++){\n\t\t\tint u, v, w;\n\t\t\tcin >> u >> v >> w;\n\t\t\tu--, v--;\n\t\
    \t\tG[u].emplace_back(v, w);\n\t\t\tG[v].emplace_back(u, w);\n\t\t}\n\t\tfor(auto\
    \ &&v : ter) cin >> v, v--;\n\t\tint tmp = ter.back();\n\t\tter.pop_back();\n\t\
    \tcout << steiner_tree(G, ter)[tmp] << '\\n';\n\t}else{\n\t\tvector<tuple<int,int,int>>\
    \ edge(M);\n\t\tfor(auto &&[u, v, w] : edge){\n\t\t\tcin >> u >> v >> w;\n\t\t\
    \tu--, v--;\n\t\t\tswap(u, w);\n\t\t}\n\t\tlong long S = (1ll << N) - 1;\n\t\t\
    int ans = 1 << 30;\n\t\tfor(auto &&v : ter) {\n\t\t\tcin >> v;\n\t\t\tv--;\n\t\
    \t\tS ^= 1ll << v;\n\t\t}\n\t\tsort(edge.begin(), edge.end());\n\t\tfor(long long\
    \ U = S; U >= 0; U = (U - 1) & S){\n\t\t\tint sv = 0;\n\t\t\tatcoder::dsu uf(N);\n\
    \t\t\tfor(auto &&[w, u, v] : edge){\n\t\t\t\tif((U >> u & 1) || (U >> v & 1) ||\
    \ uf.same(u, v)) continue;\n\t\t\t\tuf.merge(u, v);\n\t\t\t\tsv += w;\n\t\t\t\
    }\n\t\t\tif(uf.size(ter[0]) + __builtin_popcountll(U) == N){\n\t\t\t\tans = min(ans,\
    \ sv);\n\t\t\t}\n\t\t\tif(U == 0) break;\n\t\t}\n\t\tcout << ans << '\\n';\n\t\
    }\n}\n"
  code: "#define PROBLEM \"https://yukicoder.me/problems/no/114\"\n\n#include <bits/stdc++.h>\n\
    #include <atcoder/all>\n#include \"Graph/steiner_tree.hpp\"\nusing ll = long long;\n\
    \nusing namespace std;\n\nint main(){\n\tios::sync_with_stdio(false);\n\tcin.tie(0);\n\
    \tint N, M, T;\n\tcin >> N >> M >> T;\n\tvector<int> ter(T);\n\tif(T <= 16){\n\
    \t\tvector<vector<pair<int,int>>> G(N);\n\t\tfor(int i = 0; i < M; i++){\n\t\t\
    \tint u, v, w;\n\t\t\tcin >> u >> v >> w;\n\t\t\tu--, v--;\n\t\t\tG[u].emplace_back(v,\
    \ w);\n\t\t\tG[v].emplace_back(u, w);\n\t\t}\n\t\tfor(auto &&v : ter) cin >> v,\
    \ v--;\n\t\tint tmp = ter.back();\n\t\tter.pop_back();\n\t\tcout << steiner_tree(G,\
    \ ter)[tmp] << '\\n';\n\t}else{\n\t\tvector<tuple<int,int,int>> edge(M);\n\t\t\
    for(auto &&[u, v, w] : edge){\n\t\t\tcin >> u >> v >> w;\n\t\t\tu--, v--;\n\t\t\
    \tswap(u, w);\n\t\t}\n\t\tlong long S = (1ll << N) - 1;\n\t\tint ans = 1 << 30;\n\
    \t\tfor(auto &&v : ter) {\n\t\t\tcin >> v;\n\t\t\tv--;\n\t\t\tS ^= 1ll << v;\n\
    \t\t}\n\t\tsort(edge.begin(), edge.end());\n\t\tfor(long long U = S; U >= 0; U\
    \ = (U - 1) & S){\n\t\t\tint sv = 0;\n\t\t\tatcoder::dsu uf(N);\n\t\t\tfor(auto\
    \ &&[w, u, v] : edge){\n\t\t\t\tif((U >> u & 1) || (U >> v & 1) || uf.same(u,\
    \ v)) continue;\n\t\t\t\tuf.merge(u, v);\n\t\t\t\tsv += w;\n\t\t\t}\n\t\t\tif(uf.size(ter[0])\
    \ + __builtin_popcountll(U) == N){\n\t\t\t\tans = min(ans, sv);\n\t\t\t}\n\t\t\
    \tif(U == 0) break;\n\t\t}\n\t\tcout << ans << '\\n';\n\t}\n}\n"
  dependsOn:
  - Graph/steiner_tree.hpp
  isVerificationFile: true
  path: Test/yukicoder/yuki0114.test.cpp
  requiredBy: []
  timestamp: '2024-08-03 19:20:35+09:00'
  verificationStatus: TEST_WRONG_ANSWER
  verifiedWith: []
documentation_of: Test/yukicoder/yuki0114.test.cpp
layout: document
redirect_from:
- /verify/Test/yukicoder/yuki0114.test.cpp
- /verify/Test/yukicoder/yuki0114.test.cpp.html
title: Test/yukicoder/yuki0114.test.cpp
---
